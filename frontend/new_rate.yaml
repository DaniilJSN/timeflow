# New rate menu
id: new_rate
type: PageSiderMenu
properties:
  logo:
    src: http://localhost:3000/public/logo_web.svg
requests:
  - id: post_rate
    type: AxiosHttp
    connectionId: app_api
    properties:
      url: /api/rate/
      method: post
      data:
        _state: new_rate_data
events:
  onEnter:
    - id: set_is_submit_visible
      type: SetState
      params:
        is_submit_visible: false
areas:
  content:
    blocks:
      - id: user_initials
        type: Selector
        layout:
            span: 5
        properties:
          placeholder: user initials
          label:
            disabled: true
        required: True

      - id: client_name
        type: Selector
        layout:
            span: 5
        properties:
          placeholder: client name
          label:
            disabled: true
        required: True

      - id: currency
        type: TextInput
        layout:
            span: 5
        properties:
          placeholder: Currency
          label:
            disabled: true
        required: True

      - id: client_rate
        type: TextInput
        layout:
            span: 5
        properties:
          placeholder: New Client rate
          label:
            disabled: true
        required: True

      - id: check_button
        type: Button
        layout:
          span: 2
        properties:
          title: Check rate
          color: '#595959'
          type: primary
        events:
          onClick:
            - id: check_rate
              type: SetState
              params:
                check_text: 
                  _nunjucks: |
                        #### You are logging time for:
                        |        user      |      client     |    currency    |    client rate   |
                        |:-----------------|:---------------:|:--------------:|:----------------:|
                        |{{user_initials}} | {{client_name}} |  {{currency}}  |{{client_rate}}|
            - id: set_submit_visible
              type: SetState
              params:
                is_submit_visible: true
      - id: reset_button
        type: Button
        layout:
          span: 2
        properties:
          title: Reset
          block: true
          type: default
        events:
          onClick:
            - id: reset
              type: Reset
            - id: set_submit_to_false
              type: SetState
              params:
                is_submit_visible: false
      - id: show_rate
        type: Markdown
        properties:
          content:
            _state: check_text
      - id: submit_rate
        type: Button
        properties:
          title: Add rate
          # icon: Sa
        layout:
          span: 3
          color: '#595959'
        visible:
          _state: is_submit_visible
        
        events:
          onClick:
            - id: validate_inputs
              type: Validate
              params:
                - client_rate
            - id: set_new_rate
              type: SetState
              params:
                new_rate_data:
                  rate:
                    _state: rate
            - id: post_rate
              type: Request
              params: post_rate
              
